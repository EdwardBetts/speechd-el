2004-10-04  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak-command-done): New variable.
	(speechd-speak--pre-command-hook): Set it to nil.
	(special-commands, buffer-switch): Don't act if
	speechd-speak-command-done is non-nil.
	(speechd-speak--command-feedback): Set speechd-speak-command-done
	to t.
	(command-done): New post-defun.
	(speechd-speak--post-command-speaking-defaults): Register it.

2004-10-01  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-unspeak): Close all connections, not
	only the current one.

	* speechd.el (speechd-close-all): New function.

2004-10-01  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (text-property-movement): Consider more text
	properties.

2004-10-01  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak-priority-insertions-in-buffers):
	"*shell*" added.
	(speechd-speak-insertions-in-buffers): "*shell*" removed.

2004-10-01  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--after-change-hook): Don't speak
	changes within specially handled interactive commands.

2004-09-30  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak-insertions-in-buffers): *shell*
	added.

2004-09-28  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (minor-modes): Report enabled modes first.
	(frame-name, frame-identification, header-line, major-mode)
	(buffer-file-coding, terminal-coding, input-method, process):
	Report the new state first; message format unified.

2004-09-27  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak-display-modes): New user option.
	(minor-modes): Honor it.

2004-09-26  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (info-change): Use EQUAL, not EQUALP.
	(minor-modes): Define SET-DIFFERENCE locally.

2004-09-25  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (minor-modes): Use LOOP instead of REMOVE-IF,
	to satisfy Elisp coding conventions.

2004-09-23  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak-state-changes): New user
	option.
	(buffer-name): Message shortened.
	(info-change): New post-defun.
	(speechd-speak--current-info): New function.
	(speechd-speak--watch): Invoke on change function with the
	priority MESSAGE.
	(speechd-speak--post-command-speaking-defaults): INFO-CHANGE
	added.
	(speechd-speak--command-info-struct): New slot INFO.
	(speechd-speak--set-command-start-info): Initialize it.

2004-09-22  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--shutdown): Just signal the
	FINISH icon, don't do anything else.

2004-09-22  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (buffer-identification, frame-identification):
	New watchers.
	(speechd-speak-buffer-info): Report buffer identification.
	(frame): Don't assign info-string and key; renamed to frame-name.
	(speechd-speak-frame-info): New function.

2004-09-22  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (buffer-name): Missing FORMAT call in
	speechd-speak--text added.

2004-09-22  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--open-connection): Clear the query-on-exit
	flag of the new process.

2004-09-22  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (header-line): New watcher.

2004-09-21  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak-info-map): New keymap.
	(speechd-speak-mode-map): Assign it to a key.
	(speechd-speak--watch): New macro.
	(speechd-speak--info-updates): New variable.
	(speechd-speak-buffer-info, speechd-speak-mode-info)
	(speechd-speak-coding-info): New commands.
	(buffer-name, buffer-modified, buffer-read-only, frame)
	(major-mode, minor-modes, buffer-file-coding, terminal-coding)
	(input-method, process): New watch definitions.

2004-09-21  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--name): New function.
	(speechd-speak--def-speak-object, speechd-speak--cinfo)
	(speechd-speak--post-defun): Use it.

2004-09-20  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak-quiet-functions): Removed.

2004-09-20  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--last-spoken-message-time): New
	variable.
	(speechd-speak-message-time-interval): New user option.
	(speechd-speak--message): Honor them.

2004-09-03  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak-version): Removed.

	* speechd.el (speechd-el-version): Removed.

	* speechd-bug.el: Require speechd-version.
	(speechd-bug-version): Removed.

	* Makefile (speechd-version.elc, speechd-version.el): New targets.
	(compile): Depend on speechd-version.elc.
	(dist): Depend on speechd-version.el.
	(maintainer-clean): Remove speechd-version.el.

2004-09-02  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--close-connection): If the connection
	process is nil, do nothing.

2004-09-02  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--send-connection): When any error occurs,
	call speechd--permanent-connection-failure; do nothing if the
	process is nil.
	(speechd--close-connection): Delete the process only if it is
	non-nil.

2004-09-02  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--open-connection): Set process input system
	to raw-text in older Emacs versions.
	(speechd--send-connection): Recode the input string in older Emacs
	versions.

2004-09-02  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--send-string): Removed.

2004-09-01  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--advanced-apo): New variable.
	(speechd--spdsend): Removed.
	(speechd-spdsend): New user option.
	(speechd--call-spdsend): Honor the changes above.
	(speechd--send-connection): Don't accept process output if
	speechd--advanced-apo is nil.
	(speechd--process-filter): Do nothing if speechd--advanced-apo is
	nil.
	(speechd--use-spdsend): New function.
	(speechd--open-connection, speechd--close-connection)
	(speechd--send-connection): Use it.
	(speechd--send-request): Handle unidirectional mode.

2004-09-01  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-host): Honor SPEECHD_HOST environment
	variable.

2004-08-26  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--spdsend): Use accept-process-output to
	figure out the default value.

2004-08-26  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-say-text): Don't call
	speechd--with-current-connection redundantly.
	(speechd--send-request): Removed.
	(speechd--process-request): Renamed to speechd--send-request.

2004-08-25  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--spdsend): Set to nil in new Emacs version.
	(speechd--connection): New slot process-output.
	(speechd--open-connection, speechd--close-connection)
	(speechd--send-connection): Support direct communication with
	Speech Dispatcher.
	(speechd--process-filter): New function.

2004-08-25  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-open): Don't initialize :failure-p with an
	unbound variable in the make-speechd--connection call.

2004-08-24  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--send-text): Remove text properties before
	sending the text.

2004-08-10  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--call-spdsend): Ensure
	last-coding-system-used is not updated by this operation.

2004-08-09  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--in-async)
	(speechd-speak--async, speechd-speak--pending-speeches)
	(speechd-speak--reading-pending-speeches)
	(speechd-speak--read-pending-speeches): Removed.
	(speechd-speak--pre-command-hook, speechd-speak--message)
	(speechd-speak--after-change-hook): Honor the change above.

	* speechd.el (speechd--blocked-p): Both the function and variable
	removed.
	(speechd--send-request): Honor the change above.

2004-08-09  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--request): ANSWER-TYPE removed.
	(speechd--process-request): Honor the change above.

2004-08-05  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--call-spdsend): Set
	process-coding-system-alist to nil before calling the process; set
	input coding to speechd--coding-system.

2004-08-05  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--process-request): Extract the parts of the
	answer only on success.

2004-08-05  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--process-name, speechd--connection-filter):
	Removed.
	(speechd--open-connection, speechd--close-connection)
	(speechd--send-connection): New functions.
	(speechd--spdsend): New variable.
	(speechd--call-spdsend): New function.
	(speechd--connection): Slot process-output removed.
	(speechd-open, speechd-close)
	(speechd--permanent-connection-failure): Use
	speechd--close-connection instead of speechd--close-process.
	(speechd--close-process): Removed.
	(speechd--permanent-connection-failure): Don't set process-output.
	(speechd-open): Updated.
	(speechd--send-string, speechd--process-request): Rewritten.
	(speechd-running-p): Removed.

2004-07-29  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak-quiet-functions): New variable;
	advise its functions.

2004-07-27  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (completions, speechd-speak-read-region): Wrap
	regular expression handling by save-match-data.

2004-07-27  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--command-feedback-region)
	(delete-backward-char, backward-delete-char)
	(backward-delete-char-untabify, delete-char, kill-region): Ensure
	the around advices return original function return value.

2004-07-24  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--with-connection-parameters): Message
	priority setting bug fixed. 

2004-07-23  Milan Zamazal  <pdm@brailcom.org>

	* speechd-bug.el (speechd-bug--dotconf-option): New function.
	(speechd-bug--insert-logs): Use it; insert Festival output module
	log.

2004-07-23  Milan Zamazal  <pdm@brailcom.org>

	* speechd-bug.el (speechd-bug-packages): New variable.
	(speechd-bug): Use it.

2004-07-20  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-say-text): Set priority only if something is
	going to be spoken.
	(speechd--with-connection-parameters): Don't restore
	message-priority at the end.

2004-07-16  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--maybe-speak*): New macro.
	(speechd-speak--maybe-speak): Use it.
	(kill-region, speechd-speak--message): Use
	speechd-speak--maybe-speak* instead of speechd-speak--maybe-speak.
	(speechd-speak--read-message): Use speechd-speak--maybe-speak.

2004-07-15  Milan Zamazal  <pdm@brailcom.org>

	* speechd-bug.el (speechd-bug--insert-log-file): Make sure the
	begin and end identifiers given to the log extractor are mutually
	different.

2004-07-15  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--el-version): Renamed to speechd-el-version.

2004-07-15  Milan Zamazal  <pdm@brailcom.org>

	* speechd-bug.el (speechd-bug--insert-general-info): `speechd'
	binary renamed to `speech-dispatcher'.

2004-07-15  Milan Zamazal  <pdm@brailcom.org>
	
	* speechd-speak.el (speechd-speak--message): Handle answers to
	y/n questions in a special way.

2004-07-15  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--read-message): Set message
	priority outside the block.

2004-07-15  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (y-or-n-p): Removed.
	(speechd-speak--message-timer): New variable.
	(speechd-speak--message-timer): New function.
	(speechd-speak): Setup speechd-speak--message-timer.
	(speechd-unspeak): Cancel the timer.

2004-07-13  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--read-message): Enclose the
	signal and message by a block.

2004-06-24  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--unhide-message): New macro.
	(write-region): Unhide message.

2004-06-24  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak-read-mode-line): New command.
	(speechd-speak-mode-map): Add a key binding for it.	

2004-06-02  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--default-connection-parameters): Define
	symbolic parameter values, not SSIP strings.
	(speechd--with-connection-parameters): Retrieve current
	connection parameters only once, not in the loop.

2004-06-02  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-add-connection-settings): Don't set
	spelling-mode; set enumerated parameters properly.
	(speechd--voice-name): Use lower case voice names.

2004-05-28  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-connection-parameters): Removed.
	(speechd-open, speechd-add-connection-settings): Honor the change
	above.

2004-05-27  Milan Zamazal  <pdm@brailcom.org>

	* speechd-el 0.4 released.

2004-05-27  Milan Zamazal  <pdm@brailcom.org>

	* Makefile (dist): Change mode of DISTDIR.

2004-05-27  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--pre-command-hook): Call
	speechd-speak--read-pending-speeches before cancel.

2004-05-25  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--message, speechd-speak--async):
	New functions.
	(speechd-speak--current-message)
	(speechd-speak--after-change-hook): Use them.
	(speechd-speak--reading-pending-speeches):
	(speechd-speak--pending-speeches): New variables.
	(speechd-speak--read-pending-speeches): New function.
	(speechd-speak--pre-command-hook): Call it.
	(speechd-speak--in-async): New variable.
	(speechd-speak--maybe-speak): Don't check for blocked connections.
	(speechd-speak--read-message, speechd-speak--read-buffer-change):
	New functions.

2004-05-25  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--connection): Slot reading-answer-p removed.
	(speechd--permanent-connection-failure): Honor the change above.
	(speechd--blocked-p): New variable.
	(speechd-blocked-p): Use it instead of connection checking.
	(speechd--process-request): Set the new variable instead of the
	removed slot.
	(speechd--send-request): speechd-blocked-p call updated.

2004-05-25  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--after-change-hook): Reporting
	of asynchronous changes fixed.

2004-05-24  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--maybe-speak): Protect against
	blocked speech output calls.

2004-05-24  Milan Zamazal  <pdm@brailcom.org>
	
	* speechd.el (speechd--connection): Slot request-queue removed.
	(speechd--permanent-connection-failure): Honor the change above.
	(speechd--protect, speechd-protect): Removed.
	(speechd-blocked): New function.
	(speechd--in-recursion, speechd--process-queues): Removed.
	(speechd--process-request): No queues anymore.
	(speechd--send-request): No queueing, signal error when invoked on
	a blocked connection.
	(speechd--maximum-queue-length, speechd--queue-too-long-p):
	Removed.

2004-05-20  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak-last-message)
	(speechd-speak--speak-minibuffer-prompt)
	(speechd-speak--minibuffer-prompt, completions): Bind
	speechd-speak-input-method-languages to nil.
	(speechd-speak--maybe-speak): Honor
	speechd-speak-input-method-languages.

	* speechd.el (speechd-input-method-languages): Moved to
	speechd-speak.el and renamed to
	speechd-speak-input-method-languages.
	(speechd--current-language): Don't check input methods.

2004-05-18  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-input-method-languages): New user option.
	(speechd--current-language): New function.
	(speechd-say-text, speechd-say-char, speechd-say-key): Use it.

2004-05-18  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak-allow-prompt-commands): New
	user option.
	(read-char-exclusive): Honor it.

2004-05-14  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-open): If FORCE-REOPEN is non-nil, prefer
	default parameters over current connection parameters.
	(speechd-voices): Call speechd-reopen in the set method.

2004-05-14  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-voices): `name' tag clarified.

2004-05-14  Milan Zamazal  <pdm@brailcom.org>
	
	* speechd-speak.el (speechd-speak--read-changes): New function.
	(speechd-speak--last-other-changes)
	(speechd-speak--last-other-changes-buffer): New variables.
	(speechd-speak--read-other-changes): Set them; use
	speechd-speak--read-changes.
	(speechd-speak-last-insertions): New command.
	(speechd-speak-mode-map, speechd-speak-read-char-keymap): Its
	keybinding added.

2004-05-13  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak-read-char-keymap): New keymap.
	(read-char-exclusive): New advice.

2004-05-12  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-say-text): New argument SAY-IF-EMPTY.

2004-05-11  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-say-text): Don't speak if text is empty.

2004-05-11  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--send-text): Check for command errors and
	perform appropriate actions.

2004-05-11  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--send-request, speechd--send-command): NOW
	argument removed.
	(speechd--send-text): Honor the change above.

2004-05-11  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--send-text, speechd--send-command): Don't
	call make-speechd--request with the answer-type argument.
	(speechd--process-request): Code cleanup.

2004-05-11  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--send-command): DELAY-ANSWER argument
	removed.
	(speechd--send-text): Honor the change above.
	(speechd--process-queues): Redundant answer-type setting removed.

2004-05-11  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--connection, speechd--request):
	transaction-state and new-state slots removed.
	(speechd--permanent-connection-failure, speechd--send-request) 
	(speechd--send-command): Transaction state support removed.	
	(speechd--send-data-begin, speechd--send-data-end): Removed.
	(speechd--send-data): Renamed to speech--send-text and changed to
	send complete SPEAK command.
	(speechd-say-text): Honor the changes above.

2004-05-11  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-say-text): FINISH argument removed.

2004-05-03  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--pre-command-hook): Don't crash
	when this-command doesn't contain a command.

2004-05-03  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--pre-command-hook): Log a
	debugging information on error.

2004-05-03  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-say-key): Don't use eql.

	* speechd-speak.el (speechd-speak--command-keys, minibuffer-exit):
	Don't use eql.

2004-04-06  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-open): Ensure the connection object is not
	created and return when the process fails.

2004-03-31  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak-signal-events)
	(speechd-speak--event-mapping): `whitespace' added.
	(speechd-speak-read-region): Report whitespace.

2004-03-29  Milan Zamazal  <pdm@brailcom.org>

	* speechd-el 0.3 released.

2004-03-25  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--client-name-set): Duplicate
	buffer locality declaration removed.
	(speechd-speak--connection-name): Use consp, not listp, when
	testing for an eval form.
	(speechd-speak--command-info-struct): New slot
	other-changes-buffer.
	(speechd-speak--after-change-hook): Set it.
	(speechd-speak--read-other-changes): Speak the changes in their
	originated buffer, not as a special area.

2004-03-25  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--in-debugger): Test whether
	edebug-active is bound.

2004-03-25  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--in-debugger): New function.
	(speechd-speak-in-debugger): New user option.
	(speechd-speak--maybe-speak): Don't speak when in debugger.
	(speechd-speak--after-change-hook) 
	(speechd-speak--pre-command-hook) 
	(speechd-speak--post-command-hook): Use speechd-speak--maybe-speak
	instead of testing the speechd-speak-mode variable.

2004-03-23  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (completions): Set speechd-language in the
	spoken buffer, not before entering it.

2004-03-23  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--command-info-struct): New slot
	completion-buffer-modified.
	(speechd-speak--set-command-start-info): Initialize it.
	(completions): New post-defun.
	(speechd-speak--post-command-speaking-defaults): Added here.
	(speechd-speak--c-buffer-name): New constant.

2004-03-17  Milan Zamazal  <pdm@brailcom.org>

	* speechd-bug.el (speechd-bug): reporter-submit-bug-report call
	argument fixed.

2004-02-24  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--voice-parameters): Bug fixes.

2004-02-20  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-voices): Voice tag label changed to "Voice".
	(speechd--block-commands): `.' added.

2004-02-19  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-add-connection-settings): Miscellaneous code
	typos fixed.
	(speechd--voice-name): Use style "1" if not given.
	(speechd-voice-tag): Symbol label improved.
	(speechd-open): Connection voice extraction fixed.
	(speechd--block-commands): Missing parentheses in SET SELF
	argument list added.
	(speechd--default-connection-parameters): New variable.
	(speechd-open): Use it; don't use speechd--default-voice.
	(speechd--default-voice): Removed.

2004-02-19  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (command-keys): The command-key bug fix fixed.

2004-02-18  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--generate-set-command): Honor prefix arg for
	all kinds of setting commands.

2004-02-18  Milan Zamazal  <pdm@brailcom.org>
	
	* speechd-speak.el (command-keys): Wrong negation in the guard
	fixed.

2004-02-18  Milan Zamazal  <pdm@brailcom.org>

	* speechd-bug.el (speechd-bug--version): Renamed to
	speechd-bug-version.
	(speechd-bug): Extract variables to report automatically, not from
	a hand prepared list.

	* speechd.el (speechd--el-version): Renamed to
	speechd-el-version.

2004-02-18  Milan Zamazal  <pdm@brailcom.org>
	
	* speechd-el.texi (Text Properties): speechd-face-voices updated.
	(Voices): New subsection.
	(Connection Parameters): Renamed to `Connection Voices' and
	updated.

2004-02-17  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-face-voices): Value type changed to
	speechd-voice-tag.
	(speechd-say-text): Honor the previous change.

2004-02-17  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-voice-tag): New widget.
	(speechd-connection-voices, speechd-voices): Use it.

2004-02-17  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--voice-name): New function.
	(speechd--voice-parameters): Handle voice definitions properly.

2004-02-17  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-voices): `Style' parameter added.

2004-02-17  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-connection-voices): New user option.
	(speechd-connection-parameters): Obsoleted.
	(speechd-open): Honor previous changes.
	(speechd-add-connection-settings): Likewise; new argument VOICE.

2004-02-14  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-voices): New user option.
	(speechd--with-voice): New macro.
	(speechd--voice-parameters): New function.

2004-02-14  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-priority-tag): Type changed to `choice'.

2004-02-13  Milan Zamazal  <pdm@brailcom.org>

	* speechd-el.texi (Parameter Setting Commands): Prefix argument
	documented. 

	* speechd.el (speechd--generate-set-command): Support for prefix
	arg added.
	(speechd--set-parameter): New optional argument ALL.
	(speechd--set-connection-parameter, speechd-call-set-parameter):
	New functions.

2004-02-11  Milan Zamazal  <pdm@brailcom.org>

	* speechd-log-extractor: Use /usr/bin/env instead of a hard-wired
	perl path.

	* speechd-bug.el (speechd-bug--log-extractor): Fixed.

2004-02-11  Milan Zamazal  <pdm@brailcom.org>

	* speechd-log-extractor: Main loop fixed; copyright added.

	* speechd-bug.el (speechd-bug--log-extractor): `perl' added.
	(speechd-bug--insert-log-file): Encode the compressed file with
	uuencode.

2004-02-11  Milan Zamazal  <pdm@brailcom.org>
	
	* speechd-el.texi (Installation): Recommended Speech Dispatcher
	version added.

2004-02-11  Milan Zamazal  <pdm@brailcom.org>

	* speechd-el.texi (Parameter Setting Commands): speechd-set-volume
	documented.
	(Connection Parameters): Volume added.

	* speechd-speak.el (speechd-speak-mode-map): Volume setting key
	added.

	* speechd.el (speechd-connection-parameters) 
	(speechd--parameter-names, speechd--block-commands): Volume
	support added.
	(volume): New parameter setting command.

2004-02-09  Milan Zamazal  <pdm@brailcom.org>

	* speechd-el.texi (Installation): Installation of
	speechd-log-extractor.
	* README (Installation): Likewise.

	* speechd-bug.el (speechd-bug--insert-log-file): Use the Perl
	script instead of awk.
	(speechd-bug--log-extractor): New variable.

	* speechd-log-extractor: New script.

2004-01-19  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-open): Unused forced-priority variable
	removed.

	* speechd-bug.el (speechd-bug--finish-repro-key): Value changed to
	"\C-f".
	* speechd-el.texi (Bug Reporting): Document it.
	* NEWS: Likewise.

2003-12-31  Milan Zamazal  <pdm@brailcom.org>

	* speechd-el.texi (Bug Reporting): speechd-bug-reproduce
	documented.
	* speechd-bug.el (speechd-bug--start-repro): Renamed to
	speechd-bug-reproduce.  Made interactive.
	(speechd-bug): Honor the previous change.

2003-12-30  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--connection): New slot last-command.
	(speechd--send-command): Set it.
	(speechd--iterate-clients): New macro.
	(speechd--iterate-connections-collect): Removed.
	(speechd-connection-names): Rewritten.
	(speechd--control-command): Rewritten; numeric ALL argument value
	honored.
	(speechd-cancel, speechd-cancel): Utilize the previous change.
	(speechd--control-command): New optional argument REPEATABLE.
	(speechd-stop): Honor the previous change.
	(speechd-pause, speechd-resume): When ALL is non-nil, handle all
	connections correctly; ensure proper ALL value for
	speechd--control-command.
	(speechd--block-commands): New constant.
	(speechd--block-command): New function.
	(speechd--send-command): Check for block commands inside a block.

2003-12-29  Milan Zamazal  <pdm@brailcom.org>

	* speechd-bug.el (speechd-bug--insert-log-file): Use awk instead
	of sed.

2003-12-16  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--send-data): Regular expression fixed, to
	avoid performance problems.

2003-12-13  Milan Zamazal  <pdm@brailcom.org>

	* speechd-el 0.2 released.

2003-12-12  Milan Zamazal  <pdm@brailcom.org>

	* speechd-bug.el (speechd-bug--finish-repro): Disable
	speechd-speak-mode when inserting the logs.

2003-12-11  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (widget-choose): The old advice replaced by a
	completely new one, just setting widget-menu-minibuffer-flag to t.

2003-12-10  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speaking-commands): New post reading function.
	(speechd-speak--post-command-speaking-defaults):
	speechd-speak--post-read-speaking-commands added.

2003-12-09  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak-mode-map):
	speechd-speak-read-sentence added.
	* speechd-el.texi (Reading Commands): speechd-speak-read-sequence
	documented.

2003-11-13  Milan Zamazal  <pdm@brailcom.org>
	
	* speechd-speak.el (speechd-speak-mode-map): speechd-speak-spell
	added.
	(speechd-speak--current-message): Set speechd-spell to nil.

	* speechd-speak.el (speechd-speak-mode-map): No longer present
	table setting commands removed.
	
	* speechd-el.texi (Connection Parameters) 
	(Parameter Setting Commands): References to the no longer present
	commands and parameters removed.

2003-11-12  Milan Zamazal  <pdm@brailcom.org>

	* speechd-el.texi (Spelling): New section.
	* speechd.el (speechd--parameter-names)
	(speechd--parameter-value-mappings): spelling-mode added.
	(speechd-spell): New variable.
	(speechd-say-text): Honor it.
	* speechd-speak.el (speechd-speak-spell-mode): New minor mode.
	(speechd-speak-spell-command): New variable.
	(speechd-speak-spell): New command.
	(speechd-speak--pre-command-hook) 
	(speechd-speak--post-command-hook): Honor it.

2003-11-10  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-connection-parameters): Important
	punctuation setting removed.

	* Makefile (dist): Copy only files starting with letters.
	(VERSION): Increased to 0.2.
	(distclean): *.orig and *.rej added.

2003-11-06  Milan Zamazal  <pdm@brailcom.org>

	* speechd-el.texi (Parameter Setting Commands): Keys of
	speechd-speak-new-connection fixed.

	* speechd-el.cs.texi (direntry): Changed not to conflict with the
	English documentation.

	* Makefile (info-cs): New target.

2003-11-05  Milan Zamazal  <pdm@brailcom.org>

	* speechd-bug.el (speechd-bug): Use key-description for formatting
	the prefix key; use the speechd-bug--finish-repro-key variable.
	(speechd-bug--dribble-file): New variable.
	(speechd-bug--start-repro): Start outputting to a dribble file.
	(speechd-bug--insert-dribble-file): New function.
	(speechd-bug--finish-repro): Call it.
	(speechd-bug--finish-repro-key): Value changed to "\C-z".
	(speechd-bug--insert-config-file): Ask the user for the config
	file location if not found.

	* speechd-el.texi (Problems): Buffer modification reading added.

	* speechd-speak.el (special-face-movement): Don't set finished
	state if the action is string.  Read string message with priority
	MESSAGE.

	* speechd.el (speechd--send-data): Ensure control non-UTF-8 characters
	are not sent to speechd.

2003-11-04  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (read-event): New advice.

2003-11-07  Milan Zamazal  <pdm@brailcom.org>

	* speechd-el 0.1 released.

2003-11-04  Milan Zamazal  <pdm@brailcom.org>

	* speechd-el.texi (Bug Reporting): New section.

2003-11-03  Milan Zamazal  <pdm@brailcom.org>

	* speechd-el.texi (Languages): New section.

2003-10-30  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak): Use speechd-speak--signal
	instead of speechd-speak-report.

2003-10-29  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--with-connection-parameters): Don't reset
	previously unset parameters.
	(speechd--set-parameter): If correct answer is not received, don't
	set the connection parameter in the connection structure at all.

	* speechd-speak.el (speechd-speak-read-line): Make the optional
	argument prefix argument.
	* speechd-el.texi (Reading Commands): The change documented.

	* speechd-el.texi (Control Commands): Prefix arguments of control
	commands documented.

	* speechd.el (speechd-cancel): Numeric prefix argument supported.

	* speechd-speak.el (speechd-speak--dont-cancel-on-commands): New
	constant.
	(speechd-speak--pre-command-hook): Cancel messages of all
	connections.

	* speechd-bug.el (speechd-bug--insert-logs): Don't match output if
	accept-process-output returns nil.
	(speechd-bug--insert-logs): Use find-file-noselect instead of
	find-file.
	(speechd-bug--insert-logs): Look for configuration in
	/usr/local/etc/ too.

2003-10-27  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--command-keys): Take one
	optional argument instead of &rest arguments.  Enclose the keys by
	a block.
	(speechd-speak--pre-command-hook, command-keys): Honor the
	previous change.

	* speechd.el (speechd-repeat): Disabled.

	* speechd-bug.el (speechd-bug): Completion list fixed.
	(speechd-bug--version): New constant.
	(speechd-bug): Add it to the report.
	(speechd-bug--finish-repro): Switch to the mail buffer before
	inserting logs.
	(speechd-bug--insert-logs): Invalid parentheses fixed.  Exclude
	log files not starting with slash.

2003-10-24  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-block): Use
	speechd--with-connection-settings instead of own parameter
	setting.

	* speechd-bug.el (speechd-bug--insert-config-file): New argument
	COMMENT-START.
	(speechd-bug--insert-general-info): Honor the previous change.
	(speechd-bug--insert-program-version): Missing `format' call
	added.
	(speechd-bug--insert): Insert introducing new line if necessary.
	(speechd-bug--ensure-empty-line): New function.
	(speechd-bug--insert-program-version)
	(speechd-bug--insert-config-file, speechd-bug--insert-log-file):
	Use it.
	(speechd-bug--insert-logs): Insert Festival logs.
	(speechd-bug): Insert into the mail information about not
	reproducing the bug.
	(speechd-bug--insert-log-file): Add _debug_on/off to the sed
	string.
	(speechd-bug--finish-repro): Wait a second before inserting the
	logs.
	(speechd-bug--start-repro, speechd-bug--finish-repro): Send the
	_debug icons with the priority IMPORTANT.

2003-10-23  Milan Zamazal  <pdm@brailcom.org>
	
	* speechd-speak.el (speechd-speak--pre-command-hook): Speak
	self-insert-command keys with the priority NOTIFICATION.
	(speechd-speak-ignore-command-keys): Character deletion commands
	added.

	* speechd-speak.el (speechd-speak-ignore-command-keys): New user
	option.
	(speechd-speak-read-command-keys): Meaning of t changed, doc only
	change.  Default value changed to t.
	(command-keys, buffer-modifications) 
	(speechd-speak--pre-command-hook): Honor the previous changes.
	* speechd-el.texi (Basic Speaking): The previous changes
	documented.

2003-10-22  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (buffer-switch): Don't use blocks.  Speak
	buffer name with the priority `message'.
	(speechd-speak--command-keys): Wrap the code by
	speechd-speak--maybe-speak.
	(speechd-speak--buffer-substring): Protect the looking-at call by
	save-match-data.
	(read-from-minibuffer): New advice.
	(speechd-speak--minibuffer-inherited-language): New variable.
	(speechd-speak--minibuffer-setup-hook): Set speechd-language from
	it.

	* speechd.el (speechd--send-data): When sending final eol, check
	the original string, not the final rest of string.  Omit the final
	newline only for empty texts.
	(speechd-block): Ensure BLOCK END doesn't go to a different
	connection than BLOCK BEGIN.
	(speechd-set-language): Set speechd-language.
	(speechd--process-queues): Use speechd--iterate-connections.
	(speechd--process-request): Read answers of all connections before
	proceeding.

2003-10-21  Milan Zamazal  <pdm@brailcom.org>

	* speechd-el.texi (Auto-Speaking Buffers):
	speechd-speak-movement-on-insertions change documented.

	* speechd.el (speechd-language): New variable.
	(speechd-say-char, speechd-say-key, speechd-say-text): Honor it.
	(speechd--with-connection-parameters): Exclude `language' if nil.
	(speechd-block): Likewise.
	(speechd-repeat): Getting id from the speechd--send-command result
	value fixed.

	* speechd-speak.el (speechd-speak--minibuffer-prompt): Call the
	speaking function with speechd-language set to "en".
	(speechd-speak--speak-minibuffer-prompt): Likewise.
	(buffer-modifications): Ignore
	speechd-speak-movement-on-insertions.  Speak the last change of
	self-insert-command if longer than 1 character.
	(speechd-speak-movement-on-insertions): New value `read-only', set
	as the default.
	(buffer-modifications): Honor speechd-speak-movement-on-insertions
	in determining the final state.
	(speechd-speak-last-message): Say the message in English.

	* speechd.el (speechd-block): Evaluate parameters completely
	instead of just expanding them.
	* speechd-speak.el (special-commands, buffer-switch): Honor the
	previous change.

	* speechd.el (speechd--with-connection-setting): Use `defmacro'
 	instead of `defmacro*'.

2003-10-20  Milan Zamazal  <pdm@brailcom.org>

	* speechd-el.texi: Previous changes documented.

	* speechd-speak.el (beginning-of-buffer): Advice removed.
	(speechd-speak-read-rectangle): New command.
	(speechd-speak-mode-map): Change speechd-repeat to "z".  Bind
	speechd-speak-read-rectangle to "\C-r".
	(speechd-speak--emulate-minibuffer): New variable.
	(speechd-speak--connection-name): Consider it.
	(y-or-n-p, read-key-sequence): Set it.
	(speechd-speak-read-command-keys): `modification' added to the
	default value.
	(speechd-speak--command-keys): Read M-x command keys compactly.
	(speechd-speak--interactive): On interactive call, set
	speechd-default-text-priority to `message'.

	* speechd.el (speechd--send-data): Insert escaping dot before the
	dotted line, not the whole string.

2003-10-17  Milan Zamazal  <pdm@brailcom.org>

	* Makefile: speechd-bug added.

	* speechd.el (speechd-say-key): Don't crash on symbolic key names.
	
	* speechd-speak.el (speechd-speak--shutdown): sit-for increased to
	3.
	(speechd-speak--post-command-hook): Log top level errors.

	* speechd-bug.el: New file.
	* speechd-speak.el (speechd-speak-bug): Moved to speechd-bug.el.

2003-10-16  Milan Zamazal  <pdm@brailcom.org>

	* speechd-el.texi (Basic Speaking): Changes in user options
	documented.

	* speechd-speak.el (speechd-speak--debug)
	(speechd-speak--max-debug-length): New variables.
	(speechd-speak--debug): New function.
	(speechd-speak): Log the start.
	(speechd-speak--post-command-speaking-defaults): New variable.
	(speechd-speak--post-command-speaking): Default value set to nil.
	(speechd-speak): Set speechd-speak--post-command-speaking.
	(speechd-speak--post-command-hook): Handle errors.
	(buffer-modifications): If speechd-speak-buffer-insertions is
	one-line, read the first line of a multiline text instead of not
	reading anything.
	(buffer-modifications): Invalid point-moved test fixed.
	(speechd-speak--last-minibuffer-depth): New variable.
	(speechd-speak-on-minibuffer-exit): New user option.
	(speechd-speak--post-command-hook): Handle the new variables.
	(minibuffer-exit): New post-defun.
	(speechd-speak--post-command-speaking-defaults): minibuffer-exit
	added.
	(speechd-speak-bug): New command.

2003-10-15  Milan Zamazal  <pdm@brailcom.org>
	
	* speechd-speak.el (speechd-speak--shutdown): Waiting before
	cancel increased to 2.

	* speechd-speak.el (speechd-speak-buffer-name): New value `text';
	set as the default value.
	(buffer-switch): Consider the previous change; enclose the whole
	signalization into a block with the priority `text'.  Read only
	rest of the current line.
	* speechd-el.texi (Basic Speaking): The change documented.

2003-10-14  Milan Zamazal  <pdm@brailcom.org>
	
	* speechd-speak.el (speechd-speak--signal): Return t if really
	signalling.
	(speechd-speak--shutdown): Signal the `finish' icon.
	(buffer-modifications): Signal the command key instead of the
	inserted character on self-insert-command.
	(speechd-speak-read-command-name): New user option.
	(command-keys): Consider it.

	* speechd-speak.el (speechd-speak-read-command-keys): New user
	option.
	(speechd-speak--command-keys): New function.
	(speechd-speak--post-command-hook): Don't speak insertions if
	movement occurred.
	(speechd-speak-movement-on-insertions): Default value changed to
	t.
	(speechd-speak--post-command-speaking): New variable.
	(speechd-speak--post-command-hook): Most of the code moved to
	separate functions, loop over them.
	(speechd-speak--post-defun): New macro.
	(special-commands, buffer-switch, command-keys) 
	(buffer-modifications, special-face-movement) 
	(text-property-movement, plain-movement, other-window-event) 
	(other-window-buffer): New post command reading functions.
	(speechd-speak--cinfo): New macro.
	(speechd-speak--command-info-struct-buffer) 
	(speechd-speak--command-info-struct-point) 
	(speechd-speak--minibuffer-setup-hook) 
	(speechd-speak--minibuffer-exit-hook) 
	(speechd-speak--read-other-changes) 
	(speechd-speak--add-command-text) 
	(speechd-speak--minibuffer-update) 
	(speechd-speak--after-change-hook) 
	(speechd-speak--post-command-hook): Use it.
	* speechd-el.texi (Basic Speaking):
	speechd-speak-read-command-keys documented.
	(Basic Speaking): speechd-speak-read-command-name documented.

2003-10-13  Milan Zamazal  <pdm@brailcom.org>

	* speechd-el.texi (Signalling): speechd-speak.el user option
	changes documented.

	* speechd-speak.el (speechd-signal-events): New user option.
	(speechd-speak-signal-empty)
	(speechd-speak-signal-beginning-of-line)
	(speechd-speak-signal-end-of-line): Removed.
	(speechd-speak--event-mapping): New variable.
	(speechd-speak--empty-message) 
	(speechd-speak--beginning-of-line-message) 
	(speechd-speak--end-of-line-message) 
	(speechd-speak--start-message, speechd-speak--finish-message) 
	(speechd-speak--minibuffer-message) 
	(speechd-speak--message-message): Removed.
	(speechd-speak--signal): New function.
	(speechd-speak-read-region, speechd-speak--post-command-hook)
	(speechd-speak--minibuffer-setup-hook)
	(speechd-speak--current-message): Consider the previous changes.
	(speechd-speak-read-next-line, speechd-speak-read-previous-line) 
	(speechd-speak): Likewise.
	(speechd-speak--event-mapping): New function.

	* speechd-speak.el (speechd-speak--current-message) 
	(speechd-speak--minibuffer-setup-hook): Don't enclose new sound
	icon in blocks, use normal priorities instead.

	* speechd.el (speechd-say-key): KEY type defined; true key
	handling partially implemented.

	* speechd-speak.el (speechd-speak--last-report): New variable.
	(speechd-speak-report): Use it.
	(speechd-speak--pre-command-hook): Reset it.
	(speechd-speak): Use speechd-speak--start-message instead of
	"startup" text.

2003-10-11  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--start-message) 
	(speechd-speak--finish-message) 
	(speechd-speak--minibuffer-message) 
	(speechd-speak--message-message): New variables.
	(speechd-speak--minibuffer-setup-hook) 
	(speechd-speak--current-message): Signal sound icon.

	* speechd-el.texi (Contact Information): E-mail addresses updated.

2003-10-10  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--volatile-parameters): New constant.
	(speechd--set-parameter): Consider it.

2003-10-09  Hynek Hanke  <hanke@volny.cz>

	* speechd.el (speechd--parameter-names): Added PAUSE_CONTEXT.
	(pause-context): Generate speechd-set-pause-context.

2003-10-07  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--command-info-struct): `buffer'
	and `point' replaced by `marker'.
	(speechd-speak--set-command-start-info): Consider the previous
	change.
	(speechd-speak--command-info-struct-buffer) 
	(speechd-speak--command-info-struct-point): New functions.
	(speechd-speak-movement-on-insertions): New user option.
	(speechd-speak--post-command-hook): Consider it.
	* speechd-el.texi (Auto-Speaking Buffers): Document it.

	* speechd-speak.el (speechd-speak-buffer-insertions):
	`whole-buffer' value introduced.
	(speechd-speak--post-command-hook): Consider the previous change.
	* speechd-el.texi (Auto-Speaking Buffers): Document it.

2003-10-05  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak-buffer-insertions): Extra quote
	removed.
	(speechd-speak-insertions-in-buffers)
	(speechd-speak-auto-speak-buffers)
	(speechd-speak-force-auto-speak-buffers)
	(speechd-speak-priority-insertions-in-buffers)
	(speechd-speak-by-properties-always)
	(speechd-speak-by-properties-on-movement)
	(speechd-speak-by-properties-never, speechd-speak-faces)
	(speechd-speak-connections): Explicit prompts added.
	(speechd-speak-by-properties-always)
	(speechd-speak-by-properties-never): Customization type narrowed.
	(speechd-speak-faces, speechd-speak-connections): Use the `alist'
	customization type.

	* speechd.el (speechd--generate-set-command): Table setting
	commands, no longer present in SSIP, removed.
	(speechd-connection-parameters): Consider previous change.
	(speechd--parameter-names, speechd--list-parameter-names)
	(speechd-connection-parameters): Likewise.
	(speechd-face-voices): Explicit prompt added.

2003-10-01  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-port): Default port number changed to 6560.
	(speechd-port): Use expanded form instead of ignore-errors.

2003-09-29  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-port): Use the SPEECHD_PORT environment
	variable.

2003-09-24  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--generate-set-command): Don't set the
	parameter if no input is given.  Report setting the value to the
	user.

2003-09-22  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--generate-set-command): Quote ARGDESC*.

2003-09-15  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--send-data): Intro dot handling fixed.

2003-08-29  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--send-data): Missing backslash in a regexp
	added.

2003-08-20  Milan Zamazal  <pdm@brailcom.org>

	* speechd-el.cs.texi: New file.

	* speechd-el.texi (Copying This Manual): Heading improved.

2003-08-19  Mario Lang  <mlang@delysid.org>

	* speechd.el (speechd--coding-system): Use no-conversion-dos when
	running under XEmacs.  This change makes speechd.el work with
	XEmacs 21.

2003-08-19  Mario Lang  <mlang@delysid.org>

	* speechd.el (speechd-priority-tag): Create a proper widget type
	instead of previous defconst speechd--priority-tags.
	(speechd-default-text-priority),
	(speechd-default-sound-priority),
	(speechd-default-char-priority),
	(speechd-default-key-priority),
	(speechd-connection-parameters): Use it.
	(speechd-face-voices): Use :type alist.
	(speechd-connection-parameters): Add :format "" to consts to hide them.

2003-08-19  Milan Zamazal  <pdm@brailcom.org>

	* speechd-el.texi: Direntry fixed.

	* speechd.el (speechd--priority-tags): Extra quotes removed.

2003-08-13  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-connection-parameters): Don't use cl macros
	in :get.

2003-08-08  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (beginning-of-defun): Advice removed.
	(speechd-speak-priority-insertions-in-buffers): New variable.
	(speechd-speak--after-change-hook): Consider it.
	(comint-output-filter): Advice removed.

	* speechd.el (speechd-block): Blocks enabled again.

	* speechd-el.texi (Problems): New section.
	(Auto-Speaking Buffers): Document
	speechd-speak-priority-insertions-in-buffers.

2003-08-07  Milan Zamazal  <pdm@brailcom.org>

	* Makefile (NAME, VERSION, DISTDIR, TARFILE): New variables.
	(dist): Implemented.
	(distclean): Remove DISTDIR and TARFILE.
	(mostlyclean): Remove backup files.

	* speechd.el (speechd-add-connection-settings): New command.
	* speechd-speak.el (speechd-speak-mode-map): Added.
	* speechd-el.texi (Connection Parameters):
	speechd-add-connection-parameters documented.

	* speechd-el.texi (Parameter Setting Commands):
	speechd-speak-new-connection documented.
	* speechd.el (speechd--iterate-connections-collect)
	(speechd-connection-names): New functions.
	* speechd-speak.el (speechd-speak-new-connection): New command.
	(speechd-speak-mode-map): Added here.
	(speechd-speak-new-connection): New command.
	(speechd-speak--new-connection-name): New function.
	(speechd-speak--client-name-set): New variable.
	(speechd-speak--connection-name): Use it.
	(speechd-speak--last-connection-name): Make the variable buffer
	local.

2003-08-06  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--report): New macro.
	(speechd-speak-function-feedback, speechd-speak-command-feedback):
	Use it.

	* speechd.el (speechd-connection-parameters): Call speechd-reopen
	in :set, :initialize added.
	(speechd-connection-parameters): Don't use mapcan in :set.
	(speechd-connection-parameters): In :set, parameter transfer for
	nconc fixed.

2003-08-05  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak): Message about the (re)started
	state fixed.
	(speechd-speak--minibuffer-prompt): New function.
	(minibuffer-message, read-key-sequence)
	(speechd-speak--current-message): Use it.
	(speechd-speak--read-other-changes): New function.
	(speechd-speak--after-change-hook): Use it.

2003-08-04  Milan Zamazal  <pdm@brailcom.org>
	
	* speechd-speak.el (speechd-speak): Belong to group `speechd', not
	speechd-el.
	(speechd-speak): Call speechd-speak--build-mode-map here, not on
	the top level.

	* speechd-speak.el (speechd-speak-report): Don't use string-match.
	* speechd.el (speechd--process-request, speechd--send-data):
	Enclose body in save-match-data.

2003-07-31  Milan Zamazal  <pdm@brailcom.org>
 
	* speechd-speak.el (speechd-speak--command-info-struct): New slot
	OTHER-CHANGES.
	(speechd-speak--after-change-hook): Use it; speak other changes
	only on minibuffer change.

	* speechd-speak.el (speechd-speak--post-command-hook):
	message-priority in block parameters, not `priority'.
	(speechd-unspeak): Call speechd-close.
	(speechd-speak): Prefix argument added.
	(speechd-speak-mode-map): Some key bindings changed, many new key
	bindings added.
	(speechd-speak--post-command-hook): Check overlays to when looking
	for property hit; look one character more when checking for
	previous property change.

	* speechd.el (speechd-open): Default parameter fixes and
	improvements.

2003-07-30  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-connection-parameters): Support for default
	parameters added.
	(speechd-open): Consider the previous change.
	(speechd-default-voice): Turned into a simple variable and renamed
	to speechd--default-voice.
	(speechd-default-language): Likewise.
	(speechd-open): Consider the previous change.
	(speechd--language-codes): New variable.

	* speechd-el.texi (Other commands): speechd-unspeak documented.

	* speechd-speak.el (speechd-unspeak): New command.
	(speechd-speak-mode-map): Bind it.
	(speechd-speak--defadvice): Run the advice body only if
	speechd-speak-started is non-nil.

	* Makefile (mostlyclean): Remove auxiliary Texinfo files.
	(clean): Don't remove speechd-speak.pdf; remove .elc files.

2003-07-30  Milan Zamazal  <pdm@brailcom.org>
	
	* README: Refer to the manual.
	* speechd-el.texi: Initial revision.
	* fdl.texi: Initial revision.

	* Makefile: Initial revision.

	* speechd.el (speechd-priority-tags): Renamed to
	speechd--priority-tags.
	(speechd-client-name): Docstring rewritten.
	(speechd--with-connection-setting): Don't enclose the VAR and
	VALUE arguments in parentheses.
	(speechd--process-request): Consider the previous change.
	(speechd-default-language): Language label improved.

	* speechd.el All keywords converted to non-keywords.
	(speechd--keyword->nonkeyword): Removed.
	(speechd--generate-customization-options) 
	(speechd-connection-parameters): Consider the previous change.
	(speechd--generate-set-command): Consider the previous changes.

	* speechd-speak.el: All keywords converted to non-keywords.

	* speechd.el: Most `defmacro*'s changed to `defmacro'.
	* speechd-speak.el: Likewise.
	(speechd-speak--command-feedback-region): Argument MOVE removed.

2003-07-29  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak-mode-map): Typo in
	speechd-speak-read-sexp fixed.
	(speechd-speak-mode-map): Binding for speechd-repeat added.

2003-07-28  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak-mode): Don't call
	speechd-cancel.
	(global-speechd-speak-mode): New advice.
	(speechd-speak--command-info-struct): New slot CHANGE-END; assign
	default value to CHANGES.
	(speechd-speak--set-command-start-info): Don't initialize CHANGES.
	(speechd-speak--add-command-text): Argument TEXT replaced by
	arguments BEG and END; rewritten.
	(speechd-speak--after-change-hook) 
	(speechd-speak--minibuffer-update-report): Consider the previous
	change.

	* speechd.el (speechd--set-parameter): Complain on invalid
	parameter or value instead of generating an invalid SET command.

2003-07-27  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--post-command-hook): Enforce
	speechd-speak minor modes if needed.
	(speechd-speak--enforce-speak-mode): New function.
	(speechd-speak--post-command-hook): Use it.
	(speechd-speak--minibuffer-setup-hook): Call it.
	(speechd-speak-insertions-in-buffers): New user option.
	(speechd-speak--after-change-hook): Consider it; call
	speechd-speak--enforce-speak-mode.

	* speechd.el (speechd-say-text): Don't process null properties.

2003-07-25  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-repeat): Made interactive and marked for
	autoload.

	* speechd-speak.el (speechd-speak-quiet): Removed.
	(speechd-speak-mode): New minor mode.
	(speechd-speak--maybe-speak, speechd-speak--after-change-hook)
	(speechd-speak--pre-command-hook)
	(speechd-speak--post-command-hook): Consider the previous changes.
	(speechd-speak-keymap): Renamed to speechd-speak-mode-map.
	(speechd-speak-startup-hook): Removed.
	(speechd-speak-toggle-quiet): Removed.
	(speechd-speak, speechd-speak--shutdown): Consider the previous
	changes.
	(speechd-speak): Don't add hooks -- moved to speechd-speak-mode.
	(speechd-speak): Marked for autoload.
	(global-speechd-speak-mode): New global minor mode.
	(speechd-speak-toggle): New command.
	(speechd-speak--mode-map): New variable.
	(speechd-speak-mode): Use it.
	(speechd-speak--build-mode-map): New function; call it on
	toplevel.
	(speechd-speak-prefix): Use it; :initialize added.
	(speechd-speak--prefix): New variable.
	(speechd-speak-mode): Forward declaration added.
	(speechd-speak--interactive): New macro.
	(speechd-speak-read-char, speechd-speak-read-region)
	(speechd-speak-read-line, speechd-speak-read-next-line)
	(speechd-speak-read-previous-line, speechd-speak-read-buffer)
	(speechd-speak-read-rest-of-buffer)
	(speechd-speak-read-other-window)
	(speechd-speak--def-speak-object, speechd-speak-last-message): Use
	it.
	(speechd-speak-mode-map): Don't bind kill-emacs.
	(speechd-speak--def-speak-object): Generate docstrings too.
	(speechd-speak-last-message): Docstring added.
	(speechd-speak-toggle): Renamed to speechd-speak-toggle-speaking.
	(speechd-speak-read-region): Send empty text signalization with
	speechd-default-priority, not :message priority.
	(speechd-speak-map-mode): New minor mode.
	(speechd-speak-mode): Turn it on.
	(global-speechd-speak-map-mode): New global minor mode.
	(speechd-speak): Turn it on.
	(global-speechd-speak-mode): TURN-ON argument fixed.

2003-07-24  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-connection-parameters): Special meaning of
	:message-priority introduced (doc change).
	(speechd--connection): New slot FORCED-PRIORITY.
	(speechd-open): Assign it.
	(speechd--set-parameter): Consider it.
	(speechd-language): New function.
	(speechd-say-text): Generalized, language property support added.
	(speechd--with-connection-parameter): Renamed to
	speechd--with-connection-parameters.
	(speechd-default-language): New user option.
	(speechd-open): Set the default language.
	(speechd-block): Block support temporarily disabled.
	(speechd-debug, speechd--debug-info, speechd-submit-bug-report)
	(speechd-maintainer-address): Removed.
	(speechd--connection-filter): Debugging support removed.
	(speechd--generate-set-command): Generate docstrings; list
	argument handling fixed.

	* speechd-speak.el (speechd-speak-align-buffer-insertions): New
	user option.
	(speechd-speak--buffer-substring): New function.
	(speechd-speak--after-change-hook) 
	(speechd-speak--minibuffer-update-report): Use it.
	(speechd-speak--post-command-hook): Don't read linefeed if sound
	icon is used to signal end of line.
	(speechd-speak-read-line): Argument IN-MINIBUFFER removed.
	(speechd-speak--post-command-hook): Don't call
	speechd-speak-read-line with the removed argument.
	(speechd-speak-read-next-line, speechd-speak-read-previous-line):
	Don't read any line if there's no such one; read empty text icon
	instead.

2003-07-23  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--post-command-hook): Enclose
	forward/backward-char with a block.

	* speechd.el (speechd-block): New macro.
	(speechd-say-text): Use it.
	(speechd--connection): New slot IN-BLOCK.
	(speechd-block): Be reentrant.
	(speechd-block): New argument PARAMETERS.
	(speechd-say-text): Consider the previous change.

2003-07-22  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--minibuffer-update): Forgotten
	debugging variable removed.
	(speechd-speak--set-command-start-info): If not in minibuffer, set
	minibuffer-contents to 'unset.
	(speechd-speak--minibuffer-setup-hook): Set minibuffer-contents to
	minibuffer contents.
	(speechd-speak--minibuffer-update): Do nothing if
	minibuffer-contents is 'unset.  Don't handle M-x in a special way.
	(speechd-speak): Add minibuffer-setup-hook here.  Add
	minibuffer-exit-hook.
	(speechd-speak--minibuffer-exit-hook): New function.
	(speechd-speak--with-command-start-info): New macro.
	(speechd-speak--minibuffer-setup-hook)
	(speechd-speak--minibuffer-update)
	(speechd-speak--after-change-hook)
	(speechd-speak--post-command-hook): Use it.
	(speechd-speak--add-command-text): Insert text into changes only
	if it is not equal to the first changes string.
	(speechd-speak--post-command-hook): Concatenate buffer insertions
	before checking them against speechd-speak-buffer-insertions;
	concatenate them with spaces.

2003-07-21  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--pre-command-hook): Put
	speechd-speak--after-change-hook into after-change-functions.
	(speechd-speak--after-change-hook)
	(speechd-speak--pre-command-hook)
	(speechd-speak--post-command-hook): Don't perform most actions
	when speaking is disabled.
	(speechd-speak): Put speechd-speak--after-change-hook into
	after-change-functions.
	(speechd-speak--pre-command-hook): Don't put
	speechd-speak--after-change-hook into after-change-functions.
	(speechd-speak--minibuffer-update): Update
	speechd-speak--command-info-struct-minibuffer-contents.
	(speechd-speak--minibuffer-update): Handle M-x in a special way.

2003-07-19  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak-empty-message)
	(speechd-speak-beginning-of-line-message)
	(speechd-speak-end-of-line-message): Changed to internal
	variables, naming standard speechd icons.
	(speechd-speak-signal-empty)
	(speechd-speak-signal-beginning-of-line)
	(speechd-speak-signal-end-of-line): New user options.
	(speechd-speak--post-command-hook, speechd-speak-read-region):
	Consider the previous changes.
	(speechd-speak--command-info-struct): New attribute
	MINIBUFFER-CONTENTS.
	(speechd-speak--set-command-start-info): Initialize it.
	(speechd-speak--minibuffer-update-report): New function.
	(speechd-speak--add-command-text): New function.

2003-07-18  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak-toggle-quiet): New argument
	SILENTLY.
	(speechd-speak--shutdown): New function.
	(speechd-speak): Add it to kill-emacs-hook.
	(expand-abbrev, complete-symbol, lisp-complete-symbol)
	(dabbrev-expand, comint-dynamic-complete): Feedbacks removed.
	Comint and minibuffer history handling commands removed.
	(speechd-speak--speak-minibuffer-completion): Removed.
	(speechd-speak--minibuffer-update): New function.

2003-07-17  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--command-info-struct): New slot
	CHANGE.
	(speechd-speak--set-command-start-info): Initialize it.
	(speechd-speak-buffer-insertions): New user option.
	(speechd-speak--after-change-hook): New function.  Put it into
	after-change-functions.
	(speechd-speak--post-command-hook): Read buffer modifications.

	* speechd.el (speechd--send-string): Don't assign CONNECTION
	redundantly.  Call process-send-string with PROCESS, not
	CONNECTION.
	(speechd--send-string): Don't try to reopen the connection.
	(speechd--process-request): On answer timeout, call
	speechd--permanent-connection-failure instead of speechd-close.
	(speechd-open): Don't try to open the connection if it is a failed
	connection; new key argument FORCE-REOPEN.
	(speechd-reopen): Call speechd-open with FORCE-REOPEN.

2003-07-16  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--window-contents): Enforce
	redisplay.
	(speechd-speak--def-speak-object): Don't read the last object if
	after it.

	* speechd.el (speechd-connection-parameters): Typo in a tag fixed.
	(speechd-say-text): Optimized not to call speechd--send-data
	unnecessarily many times.
	(speechd--send-string): Set connection-failure-p on reopen.

2003-07-15  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-connection-parameters): Customization
	interface improved -- :type changed and :set and :get defined.
	(speechd--punctuation-modes, speechd--capital-character-modes):
	New constants.
	(speechd--keyword->nonkeyword): New function.
	(speechd--iterate-connections): New macro.
	(speechd--control-command): If not ALL, apply the command to all
	speechd connections.
	(speechd-connection-parameters): Don't call speechd-reopen.

	* speechd-speak.el (speechd-speak-connections): :minibuffer
	allowed as the value (docstring change only).
	(speechd-speak-connection-name): Consider the previous change.
	(speechd-speak--last-connections): New variable.
	(speechd-speak--connection-name): Use it.
	(speechd-speak-connections): Functional matcher support added;
	customization overall improved.
	(speechd-speak--connection-name): Function invocation support
	added.

2003-07-09  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el: Generate capital character table commands.
	(speechd--parameter-names): :capital-character-table added.
	(speechd--list-parameter-names): :capital-character-tables added.
	(speechd--parameter-names)
	(speechd--parameter-value-mappings): capital-character-mode added.
	(speechd--generate-set-command): Support for direct completion
	definition added.
	(speechd-set-punctuation-mode): Removed.
	New setting commands: punctuation mode, chapital character mode.

2003-07-07  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-connection-parameters): Customization type
	fixed.
	(speechd-connection-parameters): Junk removed.

	* speechd-speak.el (speechd-speak-read-region): Call
	speechd-speak--text for ordinary text.

2003-07-04  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak-report): New function.
	(speechd-speak-empty-message)
	(speechd-speak-beginning-of-line-message)
	(speechd-speak-end-of-line-message): New user options.
	(speechd-speak-read-region): Use them.
	(speechd-speak--post-command-hook): Report beginnings and ends of
	lines.
	(speechd-speak--command-feedback): Unused local variable C removed.
	(speechd-speak--defadvice): Support user advices.
	(speechd-speak-function-feedback, speechd-speak-command-feedback):
	New macros.

	* speechd.el (speechd-default-voice): New user option.
	(speechd-open): Call speechd-set-voice.
	(speechd-default-voice): May be string only.
	(speechd-speak-connection-parameters): New user option.
	(speechd-open): Consider it.
	(speechd-speak-connection-parameters): Moved to the `speechd'
	group.
	(speechd-speak-connection-parameters): Renamed to
	speechd-connection-parameters.
	(speechd--connection-filter): Use connection corresponding to
	PROCESS.

2003-07-03  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--connection-name): New function.
	(speechd-speak--maybe-speak): Bound its return value to
	speechd-client-naem.
	(speechd-speak-connections): New user option.
	(speechd-speak--last-buffer-mode)
	(speechd-speak--last-connection-name)
	(speechd-speak--default-connection-name)
	(speechd-speak--special-area): New variables.
	(speechd-speak--current-message): Set speechd-speak--special-area.

2003-07-02  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-face-voices): New user option.
	(speechd--with-connection-parameter): New macro.
	(speechd-say-text): Map text faces to appropriate voices.

	* speechd-speak.el (speechd-speak--current-message): New optional
	argument REPEATABLE.
	(speechd-speak--post-command-hook): Consider the previous change.
	(speechd-speak--uniform-text-around-point): Limit property change
	searches.
	(speechd-speak--current-message): The argument REPEATABLE changed
	to RESET-LAST-SPOKEN.
	(speechd-speak--next-property-change)
	(speechd-speak--previous-property-change): New functions.
	(speechd-speak--post-command-hook): Use them.  Use
	get-char-property instead of get-text-property.
	(speechd-speak-force-auto-speak-buffers): New user option.
	(speechd-speak--post-command-hook): Consider it.
	(speechd-speak--next-property-change) 
	(speechd-speak--previous-property-change): Use
	*-char-property-change functions.
	(speechd-speak-connections): New variable.

2003-07-01  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--post-command-hook): Typo in the
	buffer-modified variable reference fixed.

2003-06-30  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--close-process): Don't kill or delete if the
	buffer or process respectively is nil.

	* speechd-speak.el (speechd-speak-by-properties-always)
	(speechd-speak-by-properties-never): New user options.
	(speechd-speak-by-properties-on-movement): Meaning extended to a
	list of symbols.
	(speechd-speak--post-command-hook): Consider the new user options.
	(speechd-speak--command-info-struct): New structure.
	(speechd-speak--set-command-start-info): Use it.  Add new info.
	(speechd-speak-auto-speak-buffers): New user option.
	(speechd-speak--post-command-hook): Consider the above changes.
	(speechd-speak--post-command-hook): Disable some of the
	functionality in minibuffer.
	(speechd-speak--in-minibuffer-p): New function.
	(speechd-speak-read-region): New argument EMPTY-TEXT.
	(speechd-speak-read-line): New arguement IN-MINIBUFFER.
	(speechd-speak-faces): New user option.
	(speechd-speak--post-command-hook): Support it.
	(speechd-speak--post-command-hook): Speak nothing on buffer
	modifications.

2003-06-29  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak): speechd-speak-toggle-quiet
	argument fixed.
	(speechd-speak-toggle-quiet): Argument QUIET renamed to SPEAK.
	(speechd-speak--post-command-hook): Missing argument to the
	next-property-change call added.

2003-06-28  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (kill-ring-save): Advice removed.
	(speechd-speak--pre-command-hook): Forgotten reference to
	debugging variable removed.

2003-06-27  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--speak-minibuffer-completion)
	(speechd-speak--minibuffer-setup-hook): New functions.
	(minibuffer-setup-hook): Set it as the minibuffer-setup-hook.
	(speechd-speak--speak-completion): Call
	speechd-speak--reset-command-start-info.
	(speechd-speak-prefix): :set option added.
	(kill-region, kill-ring-save): Protect the informative messages by
	speechd-speak--maybe-speak.
	(speechd-speak-by-properties-on-movement): New user option.
	(speechd-speak-whole-line): New user option.
	(speechd-speak--post-command-hook): Speak uniform text if
	possible.  Read only rests of lines if requested.
	(speechd-speak--uniform-text-around-point): New function.
	(speechd-speak--pre-command-hook): Use save-match-data.
	(speechd-speak--set-command-start-info): Store
	buffer-modification-tick to the info.
	(speechd-speak-read-line): New optional argument REST-ONLY.
	(speechd-speak-read-region): Say "empty" if the region is empty.
	(speechd-speak--started): New variable.
	(speechd-speak): Use it.

2003-06-26  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--widget-choose-buffer-name): New
	constant.
	(scroll-other-window): New advice.
	(read-key-sequence): Be safe on nil PROMPT.
	(speechd-speak-quiet): Be no more buffer local automatically.
	(speechd-speak-toggle-quiet): New PREFIX meaning, rewritten.
	(speechd-speak-set-predefined-rate): Rewritten, changed to a
	standard interactive function.
	(speechd-speak-key-set-predefined-rate): New command.  Assign it
	to the `C-e digit' keys.  Don't assign `C-e 0'.
	(speechd-speak-toggle-quiet): New argument QUIET.
	(speechd-speak): Call speechd-reopen and speechd-speak-toggle-quiet.
	(speechd-speak-prefix): Turned into a user option.

2003-06-25  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--defadvice): New macro.
	(speechd-speak--command-feedback, y-or-n-p, read-key-sequence)
	(comint-output-filter): Use it.
	(speechd-speak--current-message): New function.
	(speechd-speak--post-command-hook): Use it.
	(message): New advice.
	(speechd-speak--last-spoken-message): New variable.
	(speechd-speak--post-command-hook): Set it.
	(speechd-speak--prompt): New function.
	(speechd-speak--speak-minibuffer-prompt): Use it.
	(speechd-speak--pre-command-hook): Speak prompt of interactive
	commands not setting minibuffer really.

2003-06-24  Milan Zamazal  <pdm@brailcom.org>

	* speechd-speak.el (speechd-speak--speak-new-message): Removed;
	don't add it to after-change-functions.
	(speechd-speak--command-start-info): Be vector.
	(speechd-speak--with-minibuffer-depth): New macro.
	(speechd-speak--set-command-start-info)
	(speechd-speak--reset-command-start-info)
	(speechd-speak--command-start-info): New functions.
	(speechd-speak--pre-command-hook)
	(speechd-speak--post-command-hook)
	(speechd-speak--command-feedback): Use them.  Don't check for
	minibuffer depth.
	(speechd-speak-toggle-quiet): Call speechd-stop if the new state
	is quiet.
	(y-or-n-p): New advice.
	(read-key-sequence): New advice.
	(speechd-speak-read-other-window): New function.  Assign it a key.
	(speechd-speak-read-buffer): New optional argument BUFFER.

2003-06-13  Milan Zamazal  <pdm@brailcom.org>
	
	* speechd-speak.el (speechd-speak--speak-new-message) 
	(speechd-speak--post-command-hook): Speak message with the
	priority :progress.
	(speechd-speak--speak-new-message): Forgotten reference to `pokus'
	removed.
	(kill-sentence): speechd-speak-read-sentence call fixed.
	(transpose-chars): Typo in following-char call fixed.
	(speechd-speak--command-start-info): Moved before the first
	reference.

2003-06-13  Milan Zamazal  <pdm@brailcom.org>

	* README: Rewritten.
	* install-debian.sh: Removed.
	* speechd-emacspeak.el: Removed.
	* emacspeak.patch: Removed.
	* dtk-interp.el: Removed.

2003-06-10  Milan Zamazal  <pdm@brailcom.org>

	* speechd-emacspeak.el (message): Moved after Emacspeak start.
	Don't require emacspeak-advice anymore.

2003-06-09  Milan Zamazal  <pdm@brailcom.org>

	* speechd-emacspeak.el (message): New redefinition.

	* dtk-interp.el (dtk-interp-say): Use priority :important
	unconditionally.
	(dtk-interp-current-priority): New function.
	(dtk-interp-queue, dtk-interp-speak): Use it.
	* speechd.el (speechd-priority-tags): Changed to new speechd
	priorities.
	(speechd-default-text-priority, speechd-default-sound-priority) 
	(speechd-default-char-priority, speechd-default-key-priority):
	Values changed to the new priority values.
	(speechd--parameter-value-mappings): Updated to the new priority
	values.

2003-06-03  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-say-char): Handle linefeed in a special way
	too.

	* dtk-tcl.el (dtk-speak): Some text processing removed.
	* install-debian.sh: Patch test updated.

	* dtk-interp.el (dtk-interp-set-rate) 
	(dtk-interp-set-punctuations): Do nothing.

2003-05-30  Milan Zamazal  <pdm@brailcom.org>

	* dtk-interp.el (dtk-interp-stop): Do nothing.
	(speechd-emacspeak-no-stop, speechd-send-command): Removed.
	(dtk-interp-queue, dtk-interp-speak): Call speechd-say-text with
	:priority :medium.
	(dtk-interp-say): Call speechd-say-text with :priority.

2003-05-29  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-set-punctuation-mode): Use `assoc', not
	`rassoc'.
	(speechd--process-request): Handle connection reopen in
	check-state.  Don't try to reopen if the current state is equal to
	NEW-STATE.
	(speechd-say-text, speechd-say-text): If TEXT is empty, don't send
	it.

	* speechd-emacspeak.el (emacspeak-keymap): Map `C-e p' and `C-e
	SPC' to speechd-pause and speechd-resume respectively.

2003-05-28  Milan Zamazal  <pdm@brailcom.org>

	* speechd-emacspeak.el (comint-output-filter): New redefinition.

	* speechd.el (speechd--protect): New variable.
	(speechd-protect): New macro.
	(speechd--send-request): If speechd--protect is non-nil, queue the
	request.
	(speechd--process-queues): New function.
	(speechd--process-request): Use it.
	(speechd--send-request, speechd--send-command)
	(speechd--send-data-begin, speechd--send-data-end): New argument
	NOW.
	(speechd--process-request): Call state changing functions with the
	argument NOW.

2003-05-28  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-say-text): Don't resume paused speaking.
	* dtk-interp.el (dtk-interp-pause, dtk-interp-resume): Do nothing.

	* dtk-tcl.el (dtk-speak): Don't perform text chunking.  Other
	minor simplifications.
	* install-debian.sh: Test for the presence of the newly patched
	Emacspeak code.

	* speechd.el (speechd-open): Set process input encoding to
	raw-text.
	(speechd--send-string): Recode STRING to speechd--coding-system
	before sending it to the process.

2003-05-27  Milan Zamazal  <pdm@brailcom.org>

	* speechd-emacspeak.el (tts-restart): New redefinition.

2003-05-26  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-say-char): If CHAR is space, transform it to
	the argument `space'.
	(speechd-open): Only try to set the connection parameters, if the
	connection was successfully opened.
	(speechd--process-request): Only try to reopen an invalid-state
	connection or to read an answer if no permanent failure is
	indicated.
	(speechd--permanent-connection-failure): New function.
	(speechd--send-string): Use it.
	(speechd--generate-set-command): Support for ARGDESC nil added.
	(speechd--set-output-module): New command.
	(speechd--parameter-names): :output-module added
	(speechd--process-request): Collect answer data.
	(speechd--list): Data is in the second, not first, result element.
	(speechd--generate-set-command): Insert result of completing-read
	into list.

2003-05-25  Hynek Hanke  <hanke@localhost.localdomain>

	* speechd.el (speechd-say-char): CHAR and KEY commands are sent
	without doublequotes.

2003-05-21  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-cancel, speechd-stop, speechd-pause) 
	(speechd-resume): New argument ALL.
	(speechd-resume): Argument SOFTP removed.
	(speechd--control-command): New function.

2003-05-20  Milan Zamazal  <pdm@brailcom.org>

	* speechd-emacspeak.el (speechd-emacspeak-auditory-icon-mapping)
	(speechd-emacspeak-default-auditory-icon): New variables.
	(speechd-emacspeak-auditory-icon): New function.  Assign it to
	emacspeak-auditory-icon-function.
	(emacspeak-use-auditory-icons): Set to t.

	* speechd.el (speechd--process-request): Delay answers if
	possible.
	(speechd-set-language, speechd-set-punctuation-mode) 
	(speechd-say-text, speechd-say-sound, speechd-say-char) 
	(speechd-say-key, speechd-cancel, speechd-stop, speechd-resume) 
	(speechd-pause, speechd-submit-bug-report): Docstring added.

2003-05-17  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--process-request): Return the answer.

2003-05-17  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd--command-answer): Removed.
	(speechd--in-recursion): New variable.
	(speechd--process-request): Process the answers directly.

2003-05-16  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el: Forgotten debugging code removed.
	(speechd--send-string): Try to reopen the connection on error, set
	failure-p if unsuccessful.  Don't handle queueing.
	(speechd-running-p): Docstring added.
	(speechd--close-process): New function.
	(speechd-close): Use it.  Remove the connection from the
	connection table.
	(speechd-open): Handle both open and reopen, the latter
	correctly.  New argument `quiet'.
	(speechd-reopen): Rewritten -- reopen all connections and message
	the resulting numbers of connections.
	(speechd--connection): sending-data-p renamed to
	transaction-state.  command-queue renamed to request-queue.  New
	slot new-state.
	(speechd--set-parameter): Store the new parameter value only if
	changed successfully.  Take care about unknown parameter state.
	(speechd--with-connection-setting): New macro.
	(speechd--send-data-end): Only call speechd--send-command.
	(speechd--request): New structure.
	(speechd--send-data-begin): New function.
	(speechd--send-data): Don't handle transaction state.  Call
	speechd--send-request instead of speechd--send-string.
	(speechd--send-request): New function.
	(speechd--send-command): Use it.  New argument transaction-state.
	(speechd--process-request): New function.
	(speechd--command-answer): Miscellaneous changes.
	(speechd-resume): Update `connection' after sending the command.
	(speechd-say-text): Resume if paused.

2003-05-15  Milan Zamazal  <pdm@brailcom.org>

	* emacspeak.patch: dtk-speak.el patched to avoid
	dtk-speaker-process processing.

	* install-debian.sh: Test for need of patch of dtk-tcl.el too.
	Install dtk-interp.el.
	Don't recompile Emacspeak if not patched.

	* speechd.el (queue-f): Require queue-f.
	(speechd--make-queue, speechd--queue-empty-p, speechd--enqueue)
	(speechd--dequeue): Removed.
	(speechd--queue-too-long-p, speechd--connection)
	(speechd--send-string, speechd--command-answer)
	(speechd--send-command): Use Elib queue functions.
	(speechd--connection): Create new connection if it doesn't exist.
	New argument create-if-needed.
	(speechd-close): Call speechd--connection with the argument.
	(speechd--command-answer): Be robust against nil output.
	(speechd--send-string): New argument expect-answer, use it in
	queuing.
	(speechd--send-command): Utilize previous change.
	(speechd--command-answer): Update for the change.
	(speechd--set-parameter): Use `equal', not `eq', when comparing
	parameter values.  Set the updated parameter list.
	(speechd-say-char, speechd-say-key): Wrap the command argument by
	double quotes.
	(speechd--command-answer): Call reading recursive answer reading
	too.
	(speechd--send-command): Don't set connection process output in
	reading answer.

2003-05-14  Milan Zamazal  <pdm@brailcom.org>

	* speechd-emacspeak.el (dtk-initialize): Do nothing.
	(speechd-open, speechd-close): Removed.
	(dtk-speak-server-initialized): Set it to t.

	* speechd.el: Prefix of all private variables and constants
	changed from `speechd-' to `speechd--'.
	(speechd--buffer, speechd--client-name): Be constant.
	(speechd--maximum-queue-length): New constant.
	(speechd-client-name): New variable.
	(speechd--connection, speechd--connection-output): Removed.
	(speechd--connections): New variable.
	(speechd--connection-output, speechd--sending-data-p)
	(speechd--paused-p, speechd--current-parameters): Removed.
	(speechd--connection): New structure.
	(speechd--connection): New function.
	(speechd--process-name): Updated.
	(speechd--connection-filter): Updated.
	(speechd--last-host, speechd--last-port): Removed.
	(speechd--connection-failure): Removed.
	(speechd-close): Updated.  New argument `name'.
	(speechd--reset-connection-parameters): Removed.
	(speechd-open): Updated.  Call process-kill-without-query.
	(speechd-running-p): Updated.
	(speechd--send-string): Updated.
	(speechd--with-current-connection): New macro.
	(speechd--make-queue, speechd--queue-empty-p, speechd--enqueue)
	(speechd--dequeue, speechd--queue-too-long-p): New functions.
	(speechd--command-answer): Rewritten.
	(speechd--send-data-end): Updated.  Less protective to
	sending-data-p.
	(speechd--send-data): Updated.
	(speechd--send-command): Updated.
	(speechd--set-parameter): Updated.
	(speechd--client-name): Renamed to speechd--application-name.
	(speechd-pause): 

2003-05-07  Milan Zamazal  <pdm@brailcom.org>

	* speechd-emacspeak.el: Disable voice lock mode completely.

	* speechd.el (speechd--command-answer): Don't panic if a recursive
	accept-process-output is called -- just a temporary quick &
	incorrect hack.

2003-04-25  Milan Zamazal  <pdm@brailcom.org>

	* speechd-emacspeak.el (emacspeak-unibyte): Set it to nil.
	(dtk-speech-rate): Set to 0.
	(dtk-speech-rate-*): Set them before emacspeak-setup is loaded.
	(dtk-voice-table, dtk-family-table): Clear them.
	(dtk-default-voice-string, tts-voice-reset-code): Set them to "".

2003-04-24  Milan Zamazal  <pdm@brailcom.org>

	* dtk-interp.el (dtk-interp-queue-set-rate): Just call
	dtk-interp-set-rate.

2003-04-22  Milan Zamazal  <pdm@brailcom.org>

	* dtk-interp.el (dtk-interp-queue, dtk-interp-speak) 
	(dtk-interp-say, dtk-interp-letter) 
	(dtk-interp-toggle-capitalization, dtk-interp-set-punctuations):
	Updated for the new speechd.el.
	* speechd-emacspeak.el
	(speechd-protect-against-dtk-process-errors): Use
	speechd-running-p instead of speechd-connection.
	* speechd.el: All non-exported functions renamed to speechd--*.
	Most debugging code removed.
	(speechd-capitalizations, speechd-current-priority): Removed.
	(speechd-current-parameters): New variable.
	(speechd--reset-connection-parameters): Consider previous changes.
	(speechd--command-answer): Use string-match again.  Use prog1 for
	returning the speechd-connection-output value.  Return list of
	values, including the answer and its data.  Accept multiline
	answers correctly.
	(speechd-last-host, speechd-last-port): New variables.
	(speechd-open): Assign values to them.
	(speechd--set-parameter): New function.
	(speechd--set-connection-name): Use it.
	(speechd--convert-numeric): Return number.
	(speechd--transform-parameter-value): New function.
	(speechd-priorities, speechd-punctuations): Removed.
	(speechd-parameter-names, speechd-parameter-value-mappings): New
	constants.
	(speechd-set-priority, speechd-set-capitalization): Removed.
	(speechd-say): Renamed to speechd-say-text.
	(speechd-say-key): New function.
	(speechd-set-language): Turned into a command.
	(speechd--set-punctuation-mode-table): New constant.
	(speechd-set-punctuation-mode): New command.
	(speechd--generate-set-command): New macro.  New setting commands
	declared.
	(speechd-set-rate, speechd-set-punctuation): Removed.
	(speechd--list): New function.
	(speechd-list-parameter-names): New constant.
	(speechd-repeat): New command.
	(speechd--send-command): Arguments changed.
	(speechd-end-regexp, speechd-result-regexp)
	(speechd-success-regexp): New constants.

2003-04-17  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-set-connection-name): Prepend
	user-login-name to client name.

2003-04-16  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-priority-tags): New constant.
	(speechd-default-text-priority): Use it.
	(speechd-default-letter-priority): Use it.  Renamed to
	speechd-default-char-priority.
	(speechd-default-sound-priority, speechd-default-key-priority):
	New options.
	(speechd-say-char): Use the CHAR command.
	(speechd-say-sound): New functon.

2003-04-15  Milan Zamazal  <pdm@brailcom.org>

	* speechd-emacspeak.el (emacspeak-keymap): Assign "s" to
	speechd-stop.

	* speechd.el (speechd-cancel, speechd-stop, speechd-pause) 
	(speechd-resume): Add `self' as the command argument.

	* dtk-interp.el (dtk-interp-set-punctuations): `mode' is a string,
	not a symbol.
	(dtk-interp-stop): Call `speechd-cancel', not `speechd-stop'.

2003-04-14  Milan Zamazal  <pdm@brailcom.org>

	* dtk-interp.el (dtk-interp-set-punctuations): Changed to none,
	some, all.
	* speechd.el (speechd-punctuations): Changed to none, some, all.
	(speechd-cancel): New command.

2003-04-11  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el: All `defsubst's changed to `defun'.  Autoload
	declarations added.
	(speechd-coding-system): Changed to `defconst'.
	(speechd-command-answer): New function.
	(speechd-send-command): Use it.  Don't read speechd answer.
	(speechd-send-data): Call `speechd-command-answer'.
	(speechd-connection-output): Initialize to nil.
	(speechd-reset-connection-parameters): Reset
	`speechd-connection-output'.
	(speechd-restart): Renamed to `speechd-reopen'.

2003-04-10  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-resume): New argument `soft'.
	(speechd-send-data): Use it.
	(speechd-paused-p): New variable.
	(speechd-reset-connection-parameters, speechd-pause): Set it.
	(speechd-send-command): Don't use regexps for detection of the end
	of speechd output.

2003-04-09  Milan Zamazal  <pdm@brailcom.org>

	* speechd-emacspeak.el (dtk-speech-rate-base): Set
	dtk-speech-rate-* variables.

	* dtk-interp.el (dtk-interp-set-rate): Convert `rate' to a number
	if it is a string.

2003-04-07  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-reset-connection-parameters): New function.
	(speechd-open, speechd-set-connection-name): Use it.

2003-04-05  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-send-data-end): Do it only if
	speechd-send-data-p is non-nil.  First send command, only then set
	the variable.
	(speechd-process-name, speechd-send-string, speechd-send-command):
	Be inlined.
	(speechd-current-priority): New variable.
	(speechd-set-priority): Call the command only if `priority' is
	different of speechd-current-priority.
	(speechd-open): Reset values of the state variables.

2003-04-04  Milan Zamazal  <pdm@brailcom.org>

	* dtk-interp.el (speechd-emacspeak-queued-text): Removed.
	(dtk-interp-queue): Call `speechd-say' immediately.
	(dtk-interp-speak): Call `speechd-send-data-end'.

	* speechd.el (speechd-sending-data-p): New variable.
	(speechd-send-data-end): New function.
	(speechd-say): Call it.  New argument `finish'.  Let `priority' is
	a keyword argument.
	(speechd-send-command): Call it if sending data.
	(speechd-send-data): Send the SPEAK command only if
	speechd-sending-data-p is non-nil.  Don't send termination.  Send
	EOL only if needed.

2003-04-03  Milan Zamazal  <pdm@brailcom.org>

	* install-debian.sh: Apply emacspeak.patch if needed.

	* emacspeak.patch: New file.

	* speechd-emacspeak.el (emacspeak-speak-char) 
	(emacspeak-speak-this-char): New redefinitions.

	* speechd.el (speechd-send-command): Don't call sit-for.

2003-03-31  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-coding-system): Value set to 'utf-8-dos.
	(speechd-send-data): Rewritten to be faster.

2003-03-27  Milan Zamazal  <pdm@brailcom.org>

	* install-debian.sh: Set owner of the copied files.  chmod only
	the copied files.

	* speechd.el (speechd-eol): Value changed to "\n".
	(speechd-send-command): Don't handle \r at the end of line at all.
	sit-for call added.
	(speechd-open): Set process coding system.
	(speechd-coding-system): New option.

2003-03-26  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el (speechd-default-letter-priority): Init value changed
	to :low.
	(speechd-el-version): New constant.
	(speechd-bug-report): New command.
	(speechd-maintainer-address): New constant.
	(speechd-send-command, speechd-send-data, speechd-open) 
	(speechd-close): Push more information onto speechd-debug-info.
	(speechd-send-command): Don't message debugging information.
	(speechd-eol): New constant.
	(speechd-send-command, speechd-send-data): Use it.
	(speechd-send-command): Handle correctly input with single `\n' as
	line ending.

	* install-debian.sh: New file.

2003-03-25  Milan Zamazal  <pdm@brailcom.org>

	* speechd.el: Speech Daemon protocol changes incorporated.

2003-03-24  Milan Zamazal  <pdm@brailcom.org>

	* speechd-emacspeak.el (speechd-open): Call
	process-kill-without-query only when `speechd-conneciton' is not
	null.  Set dtk-speak-server-initialized to t unconditionally.
	(dtk-speak): New advice.
	(speechd-protect-against-dtk-process-errors): New macro, including
	its invocations.

	* speechd.el (speechd-connection-filter): New function.
	(speechd-open): Set it as the process filter function.
	(speechd-connection-output): New variable.
	(speechd-send-string): New function.
	(speechd-send-command, speechd-send-data): Use it.
	(speechd-running-p): New function.
	(speechd-connection-failure): New variable.
	(speechd-open): Set it.  Be more careful about errors.  Return
	speechd-connection.
	(speechd-send-command): Rewritten to use the variable instead of
	process buffer and to consider `speechd-connection-failure'.

